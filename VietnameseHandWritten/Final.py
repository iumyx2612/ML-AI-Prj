import cv2


image = cv2.imread("Test/196452430_172786408130254_388424802586308458_n.jpg", 0)
image = cv2.resize(image, (256, 256))
cv2.namedWindow("Orig", cv2.WINDOW_FREERATIO)
cv2.resizeWindow("Orig", 300, 300)
cv2.imshow("Orig", image)
clahe = cv2.createCLAHE(clipLimit=2.0, tileGridSize=(8,8))
cl1 = clahe.apply(image)
cv2.namedWindow("clahe", cv2.WINDOW_FREERATIO)
cv2.resizeWindow("clahe", 300, 300)
cv2.imshow("clahe", cl1)
'''hst = cv2.equalizeHist(image)
cv2.namedWindow("Hst", cv2.WINDOW_FREERATIO)
cv2.resizeWindow("Hst", 300, 300)
cv2.imshow("Hst", hst)'''
ret, thresh = cv2.threshold(image, 100, 255, cv2.THRESH_BINARY_INV)
cv2.namedWindow("Thresh", cv2.WINDOW_FREERATIO)
cv2.resizeWindow("Thresh", 300, 300)
cv2.imshow("Thresh", thresh)
dilate = cv2.dilate(thresh, (5, 5), iterations=4)
cv2.namedWindow("Dilate", cv2.WINDOW_FREERATIO)
cv2.resizeWindow("Dilate", 300, 300)
cv2.imshow("Dilate", dilate)
final = cv2.resize(dilate, (128, 128))
cv2.namedWindow("final", cv2.WINDOW_FREERATIO)
cv2.resizeWindow("final", 300, 300)
cv2.imshow("final", final)
cv2.waitKey(0)